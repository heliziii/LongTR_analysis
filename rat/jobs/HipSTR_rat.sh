#!/bin/bash
#SBATCH -p condo
#SBATCH -q condo
#SBATCH --account=ddp268
#SBATCH -J LongTR_rat
#SBATCH -t 50:00:00
#SBATCH -o /tscc/projects/ps-gymreklab/helia/HipSTR_LR/tests/rat/log/LongTR-%j.err-%N
#SBATCH -e /tscc/projects/ps-gymreklab/helia/HipSTR_LR/tests/rat/log/LongTR-%j.err-%N
#SBATCH -N 1
#SBATCH -n 1
#SBATCH -c 4

n=$1
dir=/tscc/projects/ps-gymreklab/helia/HipSTR_LR/tests/rat
data_dir=/tscc/projects/ps-palmer/DenghuiChen/1U01DA051234/HS/aligned/haplotaged_bams

time /tscc/projects/ps-gymreklab/helia/HipSTR_LR/LongSTR/LongTR \
--bams $data_dir/00077E67B5.haplotag.bam,$data_dir/00077E76C6.haplotag.bam,$data_dir/00077E76FE.haplotag.bam,$data_dir/00077E7A63.haplotag.bam,$data_dir/00077E8336.haplotag.bam,$data_dir/00077E9BAA.haplotag.bam,$data_dir/00077EA7E6.haplotag.bam,$data_dir/000789FF6E.haplotag.bam,$data_dir/000789FF7D.haplotag.bam,$data_dir/000789FF94.haplotag.bam,$data_dir/000789FFAC.haplotag.bam,$data_dir/000789FFD3.haplotag.bam,$data_dir/000789FFF0.haplotag.bam,$data_dir/000789FFF8.haplotag.bam,$data_dir/000789FFF9.haplotag.bam,$data_dir/00078A002C.haplotag.bam,$data_dir/00078A0041.haplotag.bam,$data_dir/00078A0058.haplotag.bam,$data_dir/00078A0085.haplotag.bam,$data_dir/00078A00AC.haplotag.bam,$data_dir/00078A00BF.haplotag.bam,$data_dir/00078A0127.haplotag.bam,$data_dir/00078A0138.haplotag.bam,$data_dir/00078A0139.haplotag.bam,$data_dir/00078A0166.haplotag.bam,$data_dir/00078A0189.haplotag.bam,$data_dir/00078A01A6.haplotag.bam,$data_dir/00078A01C0.haplotag.bam,$data_dir/00078A01D8.haplotag.bam,$data_dir/00078A01DB.haplotag.bam,$data_dir/00078A01FE.haplotag.bam,$data_dir/00078A0215.haplotag.bam,$data_dir/00078A021A.haplotag.bam,$data_dir/00078A0224.haplotag.bam,$data_dir/00078A022D.haplotag.bam,$data_dir/00078A0244.haplotag.bam,$data_dir/00078A0246.haplotag.bam,$data_dir/00078A0255.haplotag.bam,$data_dir/00078A02CB.haplotag.bam,$data_dir/00078A02DF.haplotag.bam,$data_dir/00078A07A2.haplotag.bam,$data_dir/00078A087B.haplotag.bam,$data_dir/00078A096C.haplotag.bam,$data_dir/00078A09B1.haplotag.bam,$data_dir/00078A0A43.haplotag.bam,$data_dir/00078A0AEA.haplotag.bam,$data_dir/00078A16D3.haplotag.bam,$data_dir/00078A16DF.haplotag.bam,$data_dir/00078A1707.haplotag.bam,$data_dir/00078A1731.haplotag.bam,$data_dir/00078A1732.haplotag.bam,$data_dir/00078A1772.haplotag.bam,$data_dir/00078A179C.haplotag.bam,$data_dir/00078A17A7.haplotag.bam,$data_dir/00078A17F7.haplotag.bam,$data_dir/00078A1807.haplotag.bam,$data_dir/00078A1816.haplotag.bam,$data_dir/00078A181B.haplotag.bam,$data_dir/00078A1837.haplotag.bam,$data_dir/00078A1863.haplotag.bam,$data_dir/00078A186C.haplotag.bam,$data_dir/00078A1875.haplotag.bam,$data_dir/00078A189F.haplotag.bam,$data_dir/00078A18CF.haplotag.bam,$data_dir/00078A18F7.haplotag.bam,$data_dir/00078A1905.haplotag.bam,$data_dir/00078A192C.haplotag.bam,$data_dir/00078A1937.haplotag.bam,$data_dir/00078A193E.haplotag.bam,$data_dir/00078A1942.haplotag.bam,$data_dir/00078A194B.haplotag.bam,$data_dir/00078A1979.haplotag.bam,$data_dir/00078A19A7.haplotag.bam,$data_dir/00078A19B5.haplotag.bam,$data_dir/00078A19C0.haplotag.bam,$data_dir/00078A19D6.haplotag.bam,$data_dir/00078A1A16.haplotag.bam,$data_dir/00078A1A2B.haplotag.bam,$data_dir/00078A1B05.haplotag.bam,$data_dir/00078A1F34.haplotag.bam,$data_dir/00078A22DF.haplotag.bam,$data_dir/00078A22EB.haplotag.bam,$data_dir/00078A2315.haplotag.bam,$data_dir/00078A2463.haplotag.bam,$data_dir/00078A2496.haplotag.bam,$data_dir/00078A2595.haplotag.bam,$data_dir/00078A261F.haplotag.bam,$data_dir/ACI_Myrna.haplotag.bam,$data_dir/BN_Myrna.haplotag.bam,$data_dir/BUF_Myrna.haplotag.bam,$data_dir/F344_B2607.haplotag.bam,$data_dir/HSRA.haplotag.bam,$data_dir/M520_Myrna.haplotag.bam,$data_dir/MR_81833.haplotag.bam,$data_dir/WKY_Myrna.haplotag.bam,$data_dir/WN_Myrna.haplotag.bam \
--fasta "$dir"/GCF_015227675.2_mRatBN7.2_genomic.fna \
--bam-samps 00077E67B5,00077E76C6,00077E76FE,00077E7A63,00077E8336,00077E9BAA,00077EA7E6,000789FF6E,000789FF7D,000789FF94,000789FFAC,000789FFD3,000789FFF0,000789FFF8,000789FFF9,00078A002C,00078A0041,00078A0058,00078A0085,00078A00AC,00078A00BF,00078A0127,00078A0138,00078A0139,00078A0166,00078A0189,00078A01A6,00078A01C0,00078A01D8,00078A01DB,00078A01FE,00078A0215,00078A021A,00078A0224,00078A022D,00078A0244,00078A0246,00078A0255,00078A02CB,00078A02DF,00078A07A2,00078A087B,00078A096C,00078A09B1,00078A0A43,00078A0AEA,00078A16D3,00078A16DF,00078A1707,00078A1731,00078A1732,00078A1772,00078A179C,00078A17A7,00078A17F7,00078A1807,00078A1816,00078A181B,00078A1837,00078A1863,00078A186C,00078A1875,00078A189F,00078A18CF,00078A18F7,00078A1905,00078A192C,00078A1937,00078A193E,00078A1942,00078A194B,00078A1979,00078A19A7,00078A19B5,00078A19C0,00078A19D6,00078A1A16,00078A1A2B,00078A1B05,00078A1F34,00078A22DF,00078A22EB,00078A2315,00078A2463,00078A2496,00078A2595,00078A261F,ACI_Myrna,BN_Myrna,BUF_Myrna,F344_B2607,HSRA,M520_Myrna,MR_81833,WKY_Myrna,WN_Myrna --bam-libs 00077E67B5,00077E76C6,00077E76FE,00077E7A63,00077E8336,00077E9BAA,00077EA7E6,000789FF6E,000789FF7D,000789FF94,000789FFAC,000789FFD3,000789FFF0,000789FFF8,000789FFF9,00078A002C,00078A0041,00078A0058,00078A0085,00078A00AC,00078A00BF,00078A0127,00078A0138,00078A0139,00078A0166,00078A0189,00078A01A6,00078A01C0,00078A01D8,00078A01DB,00078A01FE,00078A0215,00078A021A,00078A0224,00078A022D,00078A0244,00078A0246,00078A0255,00078A02CB,00078A02DF,00078A07A2,00078A087B,00078A096C,00078A09B1,00078A0A43,00078A0AEA,00078A16D3,00078A16DF,00078A1707,00078A1731,00078A1732,00078A1772,00078A179C,00078A17A7,00078A17F7,00078A1807,00078A1816,00078A181B,00078A1837,00078A1863,00078A186C,00078A1875,00078A189F,00078A18CF,00078A18F7,00078A1905,00078A192C,00078A1937,00078A193E,00078A1942,00078A194B,00078A1979,00078A19A7,00078A19B5,00078A19C0,00078A19D6,00078A1A16,00078A1A2B,00078A1B05,00078A1F34,00078A22DF,00078A22EB,00078A2315,00078A2463,00078A2496,00078A2595,00078A261F,ACI_Myrna,BN_Myrna,BUF_Myrna,F344_B2607,HSRA,M520_Myrna,MR_81833,WKY_Myrna,WN_Myrna \
--regions "$dir"/ref_set/rn7.hipstr_reference_seg"$n".bed \
--tr-vcf "$dir"/output/rat_"$n".vcf.gz \
--def-stutter-model \
--min-reads 5 \
--output-filters \
--max-tr-len 10000 \
--phased-bam \
--skip-assembly \
--log "$dir"/log/log_"$n".txt \
